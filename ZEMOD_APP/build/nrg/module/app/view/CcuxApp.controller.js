sap.ui.define(["sap/ui/core/mvc/Controller","nrg/module/app/view/App","nrg/module/app/view/AppHeader","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","jquery.sap.global"],function(a,b,c,d,e,f,g){"use strict";var h=a.extend("nrg.module.app.view.CcuxApp");return h.prototype.onBeforeRendering=function(){var a=this.getOwnerComponent().getCcuxWebUiManager();a.isAvailable()?(a.notifyWebUi("getBusinessRole",{},this._onBusinessRoleCallback,this),this._fResetChecking=setInterval(function(){a.notifyWebUi("resetTimeOut",{},this._onResetTimeCallback,this)}.bind(this),6e4)):this._onEsidToolPressCallback()},h.prototype.onAfterRendering=function(){var a=this.getOwnerComponent().getCcuxWebUiManager();a.attachEvent("clearAccount2",g.proxy(this._onClearAccPressCallback,this)),a.attachEvent("dashboardgo",g.proxy(this._onGoDashBoardCallback,this)),a.attachEvent("ToggleBusy",g.proxy(this._onToggleBusy,this))},h.prototype._onResetTimeCallback=function(a){a.mParameters&&a.mParameters.failed&&(clearInterval(this._fResetChecking),ute.ui.main.Popup.Alert({title:"Timeout",message:"Due to inactivity, your session is expired.",callback:g.proxy(this._popupCallback,this)}))},h.prototype._popupCallback=function(a){this.getOwnerComponent().getCcuxWebUiManager(),new ute.ui.commons.Tag;switch(a){case ute.ui.main.Popup.Action.Ok:document.domain="retail.nrgenergy.com",window.top.location.reload()}},h.prototype._onBusinessRoleCallback=function(a){var b=this.getView().byId("appHMItemClearAcc");a.mParameters&&"ZU_CALL_CTR"===a.mParameters&&b&&b.setVisible(!0)},h.prototype._onToggleBusy=function(a){this._oApp.setOccupied(a.mParameters.busy?!0:!1)},h.prototype.onInit=function(){this._oApp=new b(this),this.getView().setModel(sap.ui.getCore().getMessageManager().getMessageModel(),"view-message")},h.prototype.getApp=function(){return this._oApp},h.prototype._onFooterNotificationLinkPress=function(){},h.prototype._formatCampaignTime=function(a){if(a){var b=sap.ui.core.format.DateFormat.getDateInstance({pattern:"MM/yyyy"}),c=b.format(new Date(a.getTime()));return c}},h.prototype._onCampaignBtnClick=function(a){this._oApp._getFooter().onCampaignBtnClick(a)},h.prototype._onCampaignItemClick=function(a){this._oApp._getFooter().onCampaignItemClick(a)},h.prototype._onQuickLinkClick=function(a){switch(this._oApp.setHeaderMenuItemSelected(!1,b.HMItemId.Menu),a.getSource().getId()){case b.QuickLinkId.Dashboard:this._onQLDashboardClick(a);break;case b.QuickLinkId.Campaign:this._onQLCampaignClick(a);break;case b.QuickLinkId.BusinessPartner:this._onQLBusinessPartnerClick(a);break;case b.QuickLinkId.RHS:this._onQLRHSClick(a);break;case b.QuickLinkId.History:this._onQLHistoryClick(a);break;case b.QuickLinkId.HighBill:this._onQLHighBillClick(a);break;case b.QuickLinkId.SVOC:this._onQLSVOCClick(a);break;case b.QuickLinkId.Billing:this._onQLBillingClick(a);break;case b.QuickLinkId.Referral:this._onQLReferralClick(a);break;case b.QuickLinkId.BusinessEnrollment:this._onQLBiZEnrollClick(a);break;case b.QuickLinkId.ResidentialEnrollment:this._onQLResEnrollClick(a);break;case b.QuickLinkId.ServiceOrder:this._onQLServiceOrderClick(a)}},h.prototype._onQLServiceOrderClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&a.caNum&&a.coNum&&b.navTo("dashboard.ServiceOrder",{bpNum:a.bpNum,caNum:a.caNum,coNum:a.coNum})},h.prototype._onQLBillingClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&b.navTo("billing.BillingInfo",{bpNum:a.bpNum,caNum:a.caNum,coNum:a.coNum})},h.prototype._onQLBiZEnrollClick=function(){var a=this.getOwnerComponent().getCcuxWebUiManager();a.notifyWebUi("openIndex",{LINK_ID:"ZENROLLBS"})},h.prototype._onQLResEnrollClick=function(){var a=this.getOwnerComponent().getCcuxWebUiManager();a.notifyWebUi("openIndex",{LINK_ID:"ZENROLL"})},h.prototype._onQLReferralClick=function(){var a=this.getOwnerComponent().getCcuxWebUiManager();a.notifyWebUi("openIndex",{LINK_ID:"Z_SENDREF"})},h.prototype._onQLSVOCClick=function(){var a=this.getOwnerComponent().getCcuxWebUiManager();a.notifyWebUi("openIndex",{LINK_ID:"ZRELCUSFS2"})},h.prototype._onQLHighBillClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&a.caNum&&a.coNum?b.navTo("billing.HighBill",{bpNum:a.bpNum,caNum:a.caNum,coNum:a.coNum}):a.bpNum&&a.caNum&&b.navTo("billing.HighBillNoCo",{bpNum:a.bpNum,caNum:a.caNum})},h.prototype._onQLRHSClick=function(){var a=this.getOwnerComponent().getCcuxWebUiManager(),b={},c=this.getOwnerComponent().getCcuxContextManager().getContext().getData();b.LINK_ID="ZVASOPTSLN",b.REF_ID="ENROLL",c.coNum&&(b.CONTRACT_ID=c.coNum),a.notifyWebUi("openIndex",b)},h.prototype._onQLHistoryClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&a.coNum&&a.caNum&&b.navTo("usage",{bpNum:a.bpNum,caNum:a.caNum,coNum:a.coNum,typeV:"D"})},h.prototype._onQLBusinessPartnerClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&b.navTo("dashboard.BpInfo",{bpNum:a.bpNum})},h.prototype._onGoDashBoardCallback=function(a){var b;b=this.getOwnerComponent().getRouter(),a.mParameters.bpNum&&a.mParameters.caNum&&b.navTo("dashboard.VerificationWithCa",{bpNum:a.mParameters.bpNum,caNum:a.mParameters.caNum})},h.prototype._onQLDashboardClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&a.caNum&&a.coNum?b.navTo("dashboard.VerificationWithCaCo",{bpNum:a.bpNum,caNum:a.caNum,coNum:a.coNum}):a.bpNum&&a.caNum?b.navTo("dashboard.VerificationWithCa",{bpNum:a.bpNum,caNum:a.caNum}):a.bpNum&&b.navTo("dashboard.Verification",{bpNum:a.bpNum})},h.prototype._onQLCampaignClick=function(){var a,b;a=this.getOwnerComponent().getCcuxContextManager().getContext().getData(),b=this.getOwnerComponent().getRouter(),a.bpNum&&a.coNum&&a.caNum&&b.navTo("campaign",{bpNum:a.bpNum,caNum:a.caNum,coNum:a.coNum,typeV:"C"})},h.prototype._onMenuPress=function(a){this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.Menu)},h.prototype._onMessagesPress=function(a){this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.Messages)},h.prototype._onIndexPress=function(a){this.getView().getModel("view-index")||this._initIndexConfigModel(),this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.Index)},h.prototype._onTransactionPress=function(a){var b=this.getOwnerComponent().getCcuxWebUiManager();this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.Transaction),b.notifyWebUi("openIndex",{LINK_ID:"Z_CCS_MENU"})},h.prototype._onTransactionPressCallback=function(){this._oApp.setOccupied(!1)},h.prototype._onEsidToolPress=function(a){var b=this.getOwnerComponent().getCcuxWebUiManager();this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.EsidTool),this._oApp.setOccupied(!0),b.isAvailable()?b.notifyWebUi("openEsidTool",{},this._onEsidToolPressCallback,this):this._onEsidToolPressCallback()},h.prototype._onEsidToolPressCallback=function(){this._oApp.setOccupied(!1)},h.prototype._onPalPlusPress=function(a){var b=this.getOwnerComponent().getCcuxWebUiManager();this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.PalPlus),this._oApp.setOccupied(!0),b.isAvailable()?b.notifyWebUi("openPalPlus",{},this._onPalPlusPressCallback,this):this._onPalPlusPressCallback()},h.prototype._onPalPlusPressCallback=function(){this._oApp.setOccupied(!1)},h.prototype._onRefreshPress=function(a){var b,d,e,f,g,h;b=this.getOwnerComponent().getCcuxWebUiManager(),e=this.getOwnerComponent().getCcuxRouteManager(),d=this.getOwnerComponent().getRouter(),this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.Refresh),this._oApp.isInEdit()?(g=function(a){a===ute.ui.main.Popup.Action.Yes?(this._oApp.setInEdit(!1),b.isAvailable()&&b.notifyWebUi("refresh"),f=e.getCurrentRouteInfo(),d.navTo("app.refresh"),d.navTo(f.name,f.parameters)):this._oApp._getHeader().setSelected(!1,c.HMItemId.Refresh)}.bind(this),h=this.getOwnerComponent().getModel("comp-i18n-app"),ute.ui.main.Popup.Confirm({title:h.getProperty("nrgAppRefreshDataLossTitle"),message:h.getProperty("nrgAppRefreshDataLossMsg"),callback:g})):(b.isAvailable()&&b.notifyWebUi("refresh"),f=e.getCurrentRouteInfo(),d.navTo("app.refresh"),d.navTo(f.name,f.parameters))},h.prototype._onClearAccPress=function(a){var b=this.getOwnerComponent().getCcuxWebUiManager();this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.ClearAcc),this._oApp.setOccupied(!0),b.isAvailable()?b.notifyWebUi("clearAccount",{},this._onClearAccPressCallback,this):this._onClearAccPressCallback()},h.prototype._onClearAccPressCallback=function(){var a,b,c,d,e;this._oApp.setOccupied(!1),a=this.getOwnerComponent().getCcuxContextManager().resetContext(),d=this.getOwnerComponent().getRealDataManager(),d&&d.refreshODataModels(),e=this.getOwnerComponent().getGlobalDataManager(),e&&e.refreshGDC(),c=this.getOwnerComponent().getCcuxRouteManager().resetRouteHistory(),b=this.getOwnerComponent().getRouter(),b.navTo("app.refresh",null,!0),b.navTo("search.SearchNoID",null,!0)},h.prototype._onLogoffPress=function(a){var b=this.getOwnerComponent().getCcuxWebUiManager();this._oApp._getHeader().setSelected(a.getSource().getSelected(),c.HMItemId.Logout),this._oApp.setOccupied(!0),b.notifyWebUi("logout",{},this._onLogoffPressCallback,this)},h.prototype._onLogoffPressCallback=function(a){var b=a.getParameters();b.CANCEL&&"X"===b.CANCEL&&this._oApp.setOccupied(!1)},h.prototype._initIndexConfigModel=function(){var a,b;return a=this.getOwnerComponent().getCcuxWebUiManager(),a.isAvailable()?(this._oApp.setOccupied(!0),void(b=a.notifyWebUi("getIndexConfig",{},this._onInitIndexConfigModelCallback,this))):this},h.prototype._onInitIndexConfigModelCallback=function(a){var b=a.getParameters();this.getView().setModel(new d(b),"view-index"),this._oApp.setOccupied(!1)},h.prototype._onIndexLinkPress=function(a){var c,d=this.getOwnerComponent().getCcuxWebUiManager(),e={},f=this.getOwnerComponent().getCcuxContextManager().getContext().getData();this._oApp.setHeaderMenuItemSelected(!1,b.HMItemId.Index),c=a.getSource().getRefId(),e.LINK_ID=c,"ZVASOPTSLN"===c&&(e.REF_ID="ENROLL",f.coNum&&(e.CONTRACT_ID=f.coNum)),"Z_CLFULLVW"===c&&f.coNum&&(e.REF_ID=f.coNum),"ZUXINQ2"===c&&f.coNum&&(e.REF_ID=f.coNum),d.notifyWebUi("openIndex",e)},h});