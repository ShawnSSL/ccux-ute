sap.ui.define(["nrg/base/view/BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","jquery.sap.global","nrg/base/type/Price","sap/ui/model/json/JSONModel"],function(a,b,c,d,e,f){"use strict";var g=a.extend("nrg.module.campaign.view.Offers");return g.prototype.onInit=function(){},g.prototype.onAfterRendering=function(){},g.prototype.onBeforeRendering=function(){if(this.getOwnerComponent().getCcuxRouteManager().getCurrentRouteInfo().parameters&&"N"!==this.getOwnerComponent().getCcuxRouteManager().getCurrentRouteInfo().parameters.typeV){var a,b,c,e,g,h,i,j,k,l,m,n,o,p=this.getOwnerComponent().getModel("comp-campaign"),q=this.getView().byId("idnrgCamOff-Dummydisc"),r=this.getView().byId("idnrgCamOff-DummyRow").clone(),s=this,t=this.getOwnerComponent().getCcuxRouteManager().getCurrentRouteInfo(),u=new sap.ui.model.Sorter("Type",!1),v=new f({invoice:!0,invoiceFirstCard:!0,consumptionFirstCard:!0,pinFirstCardInvoice:!1,pinFirstCardConsumption:!1,pin:!1,Contract:"",proactive:0,reactive:0,save:0,finalsave:0,CYP:0,search:0,showConsumption:!0,showCYP:!1}),w=!0,x=this.getOwnerComponent().getGlobalDataManager();p.oData={},this._sContract=t.parameters.coNum,this._sBP=t.parameters.bpNum,this._sCA=t.parameters.caNum,this._sType=t.parameters.typeV,this._aSelectedComparisionCards=[],this.resetView(),this._bSearchEnabled=!1,this.getView().setModel(v,"localModel"),x.isREBS()&&v.setProperty("/showConsumption",!1),l=this.getOwnerComponent().getModel("comp-i18n-campaign"),this.getOwnerComponent().getCcuxApp().setOccupied(!0),v.setProperty("/Contract",this._sContract),this._sType&&void 0!==this._sType&&null!==this._sType&&""!==this._sType||(this._sType="SE"),k=this.getView().byId("idnrgCamHisNoData"),m=this.getView().byId("idCamToggleBtn-"+this._sType),e=this.getView().byId("idnrgCamOffScroll"),g=this.getView().byId("idnrgCamOffBt"),this._oTileTemplate=g,h=["Contract"],i=[this._sContract],c=this._createSearchFilterObject(h,i),a=l.getProperty("nrgCpgChangeOffSet"),m.addStyleClass("nrgCamOff-btn-selected"),j=function(a){var b=e.getContent(),f=e.getBinding("content"),g=0;p.create("/HttpLogS",{Contract:s._sContract,Send:n,Receive:new Date,Text:"offers"},{success:function(){d.sap.log.info("Time logged succeefully")},error:function(){d.sap.log.info("Time logged failed")}}),void 0!==b&&b.length>0?(k.addStyleClass("nrgCamOff-hide"),e.removeStyleClass("nrgCamOff-hide"),s._updateCounts(e.getContent()),h=["Type","Type"],i=["C",s._sType],c=s._createSearchFilterObject(h,i),f.sOperationMode="Client",f.bClientOperation=!0,f.aAllKeys=a.getSource().aKeys,f.filter(c,"Application"),e.getContent()&&e.getContent().length>0&&e.getContent().forEach(function(a){a&&2>g&&"C"!==a.getBindingContext("comp-campaign").getProperty("Type")&&(w?(s._changeSelectedObject(a,0,!0),s._bindCard(a,1),w=!1,v.setProperty("/invoiceFirstCard",!1)):(s._changeSelectedObject(a,1,!0),s._bindCard(a,2),v.setProperty("/invoiceFirstCard",!0)),g+=1)})):(k.removeStyleClass("nrgCamOff-hide"),e.addStyleClass("nrgCamOff-hide")),s.getOwnerComponent().getCcuxApp().setOccupied(!1),f&&f.detachDataReceived(j),g=0},o=function(){return g.clone(Math.abs(Math.random().toString().split("").reduce(function(a,b){return(a<<5)-a+b})).toString(36).substr(0,11))},b={model:"comp-campaign",path:a,factory:o,filters:c,sorter:u,parameters:{expand:"EFLs",batchGroupId:"1"},events:{dataReceived:j}},n=new Date,e.bindAggregation("content",b),a="/CustMsgS",b={model:"comp-campaign",path:a,template:r,filters:c},q.bindAggregation("content",b),this._checkCYP()}},g.prototype._checkCYP=function(){var a,b=this.getOwnerComponent().getModel("comp-campaign"),c="/CYPS('123')",e=this.getView().getModel("localModel");a={success:function(a){a&&a.ShowCYP&&e.setProperty("/showCYP",!0)}.bind(this),error:function(){d.sap.log.info("Odata Error occured")}.bind(this)},b&&b.read(c,a)},g.prototype._updateCounts=function(a){var b,c=this.getView().getModel("localModel"),d=0,e=0,f=0,g=0,h=0,i=0;a.forEach(function(a){if(a&&a.getBindingContext("comp-campaign").getProperty("Type"))switch(b=a.getBindingContext("comp-campaign").getProperty("Type")){case"P":d+=1;break;case"R":e+=1;break;case"S":f+=1;break;case"F":g+=1;break;case"Y":i+=1;break;case"SE":h+=1}}),c.setProperty("/proactive",d),c.setProperty("/reactive",e),c.setProperty("/save",f),c.setProperty("/finalsave",g),c.setProperty("/CYP",i),c.setProperty("/search",h)},g.prototype._createSearchFilterObject=function(a,d){var e,f=[];for(e=0;e<a.length;e+=1)a[e]&&d[e]&&f.push(new b(a[e],c.EQ,d[e],""));return f},g.prototype.onOfferSelected=function(a){var b=this.getView().getModel("localModel"),c=a.getSource(),d=this,e=!1;a.getSource()&&a.getSource().hasStyleClass("nrgCamOff-btnSelected")&&d._aSelectedComparisionCards.forEach(function(a){var b,d;return a&&(b=a.getBindingContext("comp-campaign").getPath()||"",d=c.getBindingContext("comp-campaign").getPath()||"",b===d)?void(e=!0):void 0}),e||(b&&b.getProperty("/invoice")?(b.getProperty("/pin")&&(b.getProperty("/pinFirstCardInvoice")?b.setProperty("/invoiceFirstCard",!1):b.setProperty("/invoiceFirstCard",!0)),b&&b.getProperty("/invoiceFirstCard")?(b.setProperty("/invoiceFirstCard",!1),this._changeSelectedObject(c,0),this._bindCard(c,1)):(b.setProperty("/invoiceFirstCard",!0),this._changeSelectedObject(c,1),this._bindCard(c,2))):(b.getProperty("/pin")&&(b.getProperty("/pinFirstCardConsumption")?b.setProperty("/consumptionFirstCard",!1):b.setProperty("/consumptionFirstCard",!0)),b&&b.getProperty("/consumptionFirstCard")?(this._changeSelectedObject(c,0),this._bindCard(c,3),b.setProperty("/consumptionFirstCard",!1)):(this._changeSelectedObject(c,1),this._bindCard(c,4),b.setProperty("/consumptionFirstCard",!0))))},g.prototype._changeSelectedObject=function(a,b,c){var d;c?(this._aSelectedComparisionCards||(this._aSelectedComparisionCards=[]),this._aSelectedComparisionCards[b]=a,this._aSelectedComparisionCards[b]&&a.addStyleClass("nrgCamOff-btnSelected")):this._aSelectedComparisionCards&&this._aSelectedComparisionCards.length>=1?(d=this._aSelectedComparisionCards[b],d&&(d.removeStyleClass("nrgCamOff-btnSelected"),a.removeStyleClass("nrgCamOff-btnSelected")),this._aSelectedComparisionCards[b]=a,this._aSelectedComparisionCards[b]&&this._aSelectedComparisionCards.forEach(function(a){a.addStyleClass("nrgCamOff-btnSelected")})):(this._aSelectedComparisionCards||(this._aSelectedComparisionCards=[]),this._aSelectedComparisionCards[b]=a,this._aSelectedComparisionCards[b]&&a.addStyleClass("nrgCamOff-btnSelected"))},g.prototype._bindCard=function(a,b){var c,d,e,g,h,i=a.getBindingContext("comp-campaign").getPath(),j=[],k=new f,l=this,m=this.getOwnerComponent().getModel("comp-campaign");if(1===b?(c=this.getView().byId("idnrgCamOff-firstCardI"),h=l.byId(sap.ui.core.Fragment.createId("Invoice1","idnrgCamOffPriceT"))):2===b?(c=this.getView().byId("idnrgCamOff-SecondCardI"),h=l.byId(sap.ui.core.Fragment.createId("Invoice2","idnrgCamOffPriceT"))):3===b?(c=this.getView().byId("idnrgCamOff-firstCardC"),h=l.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffPriceT"))):4===b&&(c=this.getView().byId("idnrgCamOff-SecondCardC"),h=l.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffPriceT"))),h&&h.removeAllAggregation("content"),c.getBindingContext("comp-campaign")&&c.unbindElement("comp-campaign"),d=m.getProperty(i+"/EFLs"),void 0!==d&&d.length>0){for(e=0;e<d.length;e+=1)j.push(m.getProperty("/"+d[e]));k.setData(l.convertEFLJson(j)),l._oEFLModel=k,g=sap.ui.view({preprocessors:{xml:{models:{tmpl:l._oEFLModel}}},type:sap.ui.core.mvc.ViewType.XML,viewName:"nrg.module.campaign.view.EFLData"}),h.removeAllAggregation("content"),h.addContent(g)}c.bindElement({model:"comp-campaign",path:i})},g.prototype.onComparisionChanged=function(a){var b,c,d=a.getSource().getContent(),e=this.getView().getModel("localModel"),f=!0,g=this;d.forEach(function(a){a.getSelected&&a.getSelected()&&(a.getKey()&&"Invoice"===a.getKey()?(f=!0,e.setProperty("/invoice",!0)):(f=!1,e.setProperty("/invoice",!1)))}),this._aSelectedComparisionCards&&0===this._aSelectedComparisionCards.length||(f?(this._aSelectedComparisionCards.forEach(function(a,b){0===b?(g._bindCard(a,1),e.setProperty("/invoiceFirstCard",!1)):(g._bindCard(a,2),e.setProperty("/invoiceFirstCard",!0))}),e.getProperty("/pin")&&(e.getProperty("/pinFirstCardConsumption")?(b=g.byId(sap.ui.core.Fragment.createId("Invoice1","nrgCamOff-PinId")),c=g.byId(sap.ui.core.Fragment.createId("Invoice1","idnrgCamOffpin")),b.setSrc("sap-icon://pushpin-on"),c.setChecked(!0),e.setProperty("/pinFirstCardInvoice",!0)):(b=g.byId(sap.ui.core.Fragment.createId("Invoice2","nrgCamOff-PinId")),c=g.byId(sap.ui.core.Fragment.createId("Invoice2","idnrgCamOffpin")),b.setSrc("sap-icon://pushpin-on"),c.setChecked(!0),e.setProperty("/pinFirstCardInvoice",!1)))):(this._aSelectedComparisionCards.forEach(function(a,b){0===b?(g._bindCard(a,3),e.setProperty("/consumptionFirstCard",!1)):(g._bindCard(a,4),e.setProperty("/consumptionFirstCard",!0))}),e.getProperty("/pin")&&(e.getProperty("/pinFirstCardInvoice")?(b=g.byId(sap.ui.core.Fragment.createId("Cons1","nrgCamOff-PinId")),c=g.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffpin")),b.setSrc("sap-icon://pushpin-on"),c.setChecked(!0),e.setProperty("/pinFirstCardConsumption",!0)):(b=g.byId(sap.ui.core.Fragment.createId("Cons2","nrgCamOff-PinId")),c=g.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffpin")),b.setSrc("sap-icon://pushpin-on"),c.setChecked(!0),e.setProperty("/pinFirstCardConsumption",!1)))))},g.prototype.toggleCYP=function(a){var b=this.getOwnerComponent().getModel("comp-i18n-campaign"),c=this.getView().getModel("localModel");parseInt(c.getProperty("/CYP"),10)>0?this.toggleTier(a):ute.ui.main.Popup.Alert({title:"Change Campaign",message:b.getProperty("nrgCmpOffCYPMsg")})},g.prototype.toggleTier=function(a){var b,c,d,e,f,g,h,i=this,j=this.getView().byId("idCamToggleBtn-P"),k=this.getView().byId("idCamToggleBtn-R"),l=this.getView().byId("idCamToggleBtn-S"),m=this.getView().byId("idCamToggleBtn-Y"),n=this.getView().byId("idCamToggleBtn-F"),o=this.getView().byId("idCamToggleBtn-SE"),p=this.getView().byId("idnrgCamHisNoData"),q=this.getOwnerComponent().getModel("comp-i18n-campaign");switch(j.removeStyleClass("nrgCamOff-btn-selected"),k.removeStyleClass("nrgCamOff-btn-selected"),l.removeStyleClass("nrgCamOff-btn-selected"),m&&m.removeStyleClass("nrgCamOff-btn-selected"),o.removeStyleClass("nrgCamOff-btn-selected"),n.removeStyleClass("nrgCamOff-btn-selected"),b=a.getSource().getId(),b=b.substring(b.length-1,b.length),this.getOwnerComponent().getCcuxApp().setOccupied(!0),g=["Type","Type"],b){case"P":h=["P","C"],this._sType="P";break;case"R":h=["R","C"],this._sType="R";break;case"S":h=["S","C"],this._sType="S";break;case"F":h=["F","C"],this._sType="F";break;case"Y":h=["Y","C"],this._sType="Y";break;default:h=["F","C"],this._sType="F"}a.getSource().addStyleClass("nrgCamOff-btn-selected"),c=this._createSearchFilterObject(g,h),d=this.getView().byId("idnrgCamOffScroll"),e=this._oTileTemplate,f=q.getProperty("nrgCpgChangeOffSet"),d.getBinding("content")&&d.getBinding("content").filter(c,"Application"),d.getContent()&&d.getContent().length>0?d.getContent().forEach(function(a){a&&i._aSelectedComparisionCards.forEach(function(b){var c,d;b&&(c=b.getBindingContext("comp-campaign").getPath()||"",d=a.getBindingContext("comp-campaign").getPath()||"",c===d&&(a.addStyleClass("nrgCamOff-btnSelected"),b=a))})}):(p.removeStyleClass("nrgCamOff-hide"),d.addStyleClass("nrgCamOff-hide")),this.getOwnerComponent().getCcuxApp().setOccupied(!1)},g.prototype.promoSearch=function(){var a,b,c,d,e,f=this.getView().byId("idnrgCamOff-search"),g=this,h=this.getView().byId("idCamToggleBtn-P"),i=this.getView().byId("idCamToggleBtn-R"),j=this.getView().byId("idCamToggleBtn-S"),k=this.getView().byId("idCamToggleBtn-F"),l=this.getView().byId("idCamToggleBtn-SE"),m=this.getView().byId("idnrgCamHisNoData"),n=this.getView().byId("idCamToggleBtn-Y"),o=(this.getOwnerComponent().getModel("comp-campaign"),this.getOwnerComponent().getModel("comp-i18n-campaign")),p=o.getProperty("nrgCpgChangeOffSet"),q=this.getView().byId("idnrgCamOffScroll"),r=this.getView().byId("idnrgCamOffBt").clone(),s=new sap.ui.model.Sorter("Type",!1);h.removeStyleClass("nrgCamOff-btn-selected"),i.removeStyleClass("nrgCamOff-btn-selected"),j.removeStyleClass("nrgCamOff-btn-selected"),n&&n.removeStyleClass("nrgCamOff-btn-selected"),k.removeStyleClass("nrgCamOff-btn-selected"),l.addStyleClass("nrgCamOff-btn-selected"),g.getOwnerComponent().getCcuxApp().setOccupied(!0),this._sType="SE",f&&f.getValue()?(this._bSearchEnabled=!0,a=["Contract","Promo"],b=[this._sContract,f.getValue()],c=this._createSearchFilterObject(a,b),d=function(e){var f=q.getContent(),h=q.getBinding("content");void 0!==f&&f.length>0?(g._updateCounts(q.getContent()),m.addStyleClass("nrgCamOff-hide"),q.removeStyleClass("nrgCamOff-hide"),a=["Type","Type"],b=["C","SE"],c=g._createSearchFilterObject(a,b),h.sOperationMode="Client",h.bClientOperation=!0,h.aAllKeys=e.getSource().aKeys,h.filter(c,"Application"),g.getOwnerComponent().getCcuxApp().setOccupied(!1)):(g._updateCounts(q.getContent()),m.removeStyleClass("nrgCamOff-hide"),q.addStyleClass("nrgCamOff-hide")),g.getOwnerComponent().getCcuxApp().setOccupied(!1),h&&h.detachDataReceived(d)},e={model:"comp-campaign",path:p,template:r,filters:c,sorter:s,parameters:{expand:"EFLs",operationMode:"Server",batchGroupId:"1"},events:{dataReceived:d}},q.bindAggregation("content",e)):(a=["Type","Type"],b=["SE","C"],c=this._createSearchFilterObject(a,b),q.getBinding("content").filter(c,"Application"),g.getOwnerComponent().getCcuxApp().setOccupied(!1))},g.prototype.selectCampaign=function(a){var b,c,d,e,g,h,i,j,k,l,m=this;return(e=a.getSource().getBindingContext("comp-campaign"))?(m.getOwnerComponent().getCcuxApp().setOccupied(!0),c=e.getPath(),b=c.substring(c.lastIndexOf("=")+1,c.lastIndexOf(")")),d=e.getProperty("OfferCode"),g=e.getProperty("LPcode"),l=e.getProperty("Type"),j=e.getProperty("Promo"),k=e.getProperty("LPReqName"),i=new f({lprefId:"",showNames:"X"===k,firstName:"",lastName:"",OfferCode:d,Date:b,LPCode:g,Promo:j,message:""}),h=function(){},g?(this._oDialogFragment||(this._oDialogFragment=sap.ui.xmlfragment("LoyalityFragment","nrg.module.campaign.view.Loyalty",this)),this._oDialogFragment.setModel(i,"oLoyalModel"),this._oLoyalityDialog||(this._oLoyalityDialog=new ute.ui.main.Popup.create({title:"Loyalty Information",close:h,content:this._oDialogFragment})),m.getOwnerComponent().getCcuxApp().setOccupied(!1),this._oLoyalityDialog.open()):(m.getOwnerComponent().getCcuxApp().setOccupied(!1),m.getOwnerComponent().setModel(i,"comp-campLocal"),this.navTo("campaignchg",{bpNum:this._sBP,caNum:this._sCA,coNum:this._sContract,offercodeNum:d,stype:l,sPromo:j})),void 0):void ute.ui.main.Popup.Alert({title:"Change Campaign",message:"Please select a campaign for comparision"})},g.prototype.formatCancelFee=function(a,b){return"Canc: "+a+" / Inc: "+b},g.prototype.pinComparisionCard=function(a){var b,c,d,e=a.getSource(),f=this,g=this.getView().getModel("localModel"),h=g.getProperty("/pin");e&&e.getChecked()?h?(e.setChecked(!1),ute.ui.main.Popup.Alert({title:"Information",message:"Only one Pin at a time"})):(g.setProperty("/pin",!0),c=e.getBindingContext("comp-campaign"),d=c.getPath(),f._aSelectedComparisionCards.forEach(function(a,c){var e,h;a&&(e=a.getBindingContext("comp-campaign"),e&&(h=e.getPath(),d===h&&(g.getProperty("/invoice")?0===c?(g.setProperty("/pinFirstCardInvoice",!0),b=f.byId(sap.ui.core.Fragment.createId("Invoice1","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-on")):(g.setProperty("/pinFirstCardInvoice",!1),b=f.byId(sap.ui.core.Fragment.createId("Invoice2","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-on")):0===c?(g.setProperty("/pinFirstCardConsumption",!0),b=f.byId(sap.ui.core.Fragment.createId("Cons1","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-on")):(g.setProperty("/pinFirstCardConsumption",!1),b=f.byId(sap.ui.core.Fragment.createId("Cons2","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-on")))))})):e&&!e.getChecked()&&(g.setProperty("/pin",!1),c=e.getBindingContext("comp-campaign"),d=c.getPath(),f._aSelectedComparisionCards.forEach(function(a,c){var e,h;a&&(e=a.getBindingContext("comp-campaign"),e&&(h=e.getPath(),d===h&&(g.getProperty("/invoice")?0===c?(b=f.byId(sap.ui.core.Fragment.createId("Invoice1","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-off")):(b=f.byId(sap.ui.core.Fragment.createId("Invoice2","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-off")):0===c?(b=f.byId(sap.ui.core.Fragment.createId("Cons1","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-off")):(b=f.byId(sap.ui.core.Fragment.createId("Cons2","nrgCamOff-PinId")),b.setSrc("sap-icon://pushpin-off")))))}))},g.prototype.formatPromo=function(a){return"Promo: "+a},g.prototype.formatCurrentConsAmount=function(a,b){return b||a?"$ "+(b||a):"N/A"},g.prototype.formatDifference=function(a,b){return a&&b?parseFloat(a)&&parseFloat(b)?"$ "+(parseFloat(a)-parseFloat(b)).toFixed(2):"$ 0.0":"N/A"},g.prototype.onDeclineLoyalty=function(){this._oLoyalityDialog.close()},g.prototype.onAcceptLoyalty=function(){var a,b,c,d,e,f,g=this.getOwnerComponent().getModel("comp-campaign"),h=this._oDialogFragment.getModel("oLoyalModel"),i=this;i.getOwnerComponent().getCcuxApp().setOccupied(!0),b=h.getProperty("/lprefId"),c=h.getProperty("/LPCode"),d=h.getProperty("/Promo"),e=h.getProperty("/OfferCode"),f=h.getProperty("/Date"),a={method:"POST",urlParameters:{LP_Code:c,LP_RefID:b,PromoCode:d},success:function(a){"E"===a.Code?(h.setProperty("/message","Please enter correct Reference Id"),i.getOwnerComponent().getCcuxApp().setOccupied(!1)):"S"===a.Code&&(i.getOwnerComponent().getCcuxApp().setOccupied(!1),i._oLoyalityDialog.close(),i.getOwnerComponent().setModel(h,"comp-campLocal"),i.navTo("campaignchg",{bpNum:i._sBP,caNum:i._sCA,coNum:i._sContract,offercodeNum:e,stype:this._sType,sPromo:d}))}.bind(this),error:function(){i.getOwnerComponent().getCcuxApp().setOccupied(!1)}.bind(this)},g.callFunction("/CheckLoyalty",a)},g.prototype.backToOverview=function(){this.navTo("campaign",{bpNum:this._sBP,caNum:this._sCA,coNum:this._sContract,typeV:"C"})},g.prototype.resetView=function(){var a,b=this.getView().byId("idnrgCamOff-firstCardI"),c=this.getView().byId("idnrgCamOff-SecondCardI"),d=this.getView().byId("idnrgCamOff-firstCardC"),e=this.getView().byId("idnrgCamOff-SecondCardC"),f=this.getView().byId("idCamToggleBtn-P"),g=this.getView().byId("idCamToggleBtn-R"),h=this.getView().byId("idCamToggleBtn-S"),i=this.getView().byId("idCamToggleBtn-F"),j=this.getView().byId("idCamToggleBtn-SE"),k=this.getView().byId("idnrgCamOff-search"),l=this.getView().byId("nrgTabBar").getContent();k.setValue(""),b.getBindingContext("comp-campaign")&&b.unbindElement("comp-campaign"),c.getBindingContext("comp-campaign")&&c.unbindElement("comp-campaign"),d.getBindingContext("comp-campaign")&&d.unbindElement("comp-campaign"),e.getBindingContext("comp-campaign")&&e.unbindElement("comp-campaign"),a=this.byId(sap.ui.core.Fragment.createId("Invoice1","idnrgCamOffPriceT")),a&&a.removeContent(0),a=this.byId(sap.ui.core.Fragment.createId("Invoice2","idnrgCamOffPriceT")),a&&a.removeContent(0),a=this.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffPriceT")),a&&a.removeContent(0),a=this.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffPriceT")),a&&a.removeContent(0),f.removeStyleClass("nrgCamOff-btn-selected"),g.removeStyleClass("nrgCamOff-btn-selected"),h.removeStyleClass("nrgCamOff-btn-selected"),i.removeStyleClass("nrgCamOff-btn-selected"),j.removeStyleClass("nrgCamOff-btn-selected"),l.forEach(function(a){a.getSelected&&(a.getKey()&&"Invoice"===a.getKey()?a.setSelected(!0):a.getSelected()&&a.setSelected(!1))})},g.prototype.convertEFLJson=function(a){var b,c,d,e,f=[],g=[],h=!1,i=[],j=[];for(c=0;c<a.length;c+=1)if(b=a[c],void 0!==b&&void 0!==b.EFLLevel&&void 0!==g){for(d=0;d<g.length;d+=1)if(b.EFLLevel===g[d]){h=!0;break}h?h=!1:(g.push(b.EFLLevel),f.push({EFLLevel:b.EFLLevel}))}for(c=0;c<a.length;c+=1)if(b=a[c],void 0!==b&&void 0!==b.EFLType&&void 0!==j){for(d=0;d<j.length;d+=1)if(b.EFLType===j[d]){h=!0;break}h?h=!1:j.push(b.EFLType)}for(e={},e.results={},e.results.columns=f,e.results.rows=[],d=0;d<j.length;d+=1){for(i=[],c=0;c<a.length;c+=1)b=a[c],void 0!==b&&void 0!==b.EFLLevel&&void 0!==b.EFLType&&b.EFLType===j[d]&&i.push(b.EFLPrice?{EFLPrice:parseFloat(b.EFLPrice).toFixed(1)}:{EFLPrice:b.EFLPrice});e.results.rows.push({cells:i})}return e},g.prototype.onEnterKeyPress=function(a){this._updateConsCmp(a.getSource().getBindingContext("comp-campaign"))},g.prototype.updateConsCmp=function(a){this._updateConsCmp(a.getSource().getBindingContext("comp-campaign"))},g.prototype._updateConsCmp=function(a){var b,c,d,e,f,g,h,i,j,k,l=(this.getView().getModel("localModel"),this),m=!0,n=this.getOwnerComponent().getModel("comp-campaign");this.getOwnerComponent().getCcuxApp().setOccupied(!0),b=a.getPath(),this._aSelectedComparisionCards.forEach(function(a,c){var d,e;a&&(d=a.getBindingContext("comp-campaign"),d&&(e=d.getPath(),b===e&&(m=0===c?!0:!1)))}),m?(c=l.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffCurrAm")),d=l.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffEstAmt")),e=l.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffEstDiff")),f=l.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffEstcents")),j=l.byId(sap.ui.core.Fragment.createId("Cons1","idnrgCamOffCons"))):(c=l.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffCurrAm")),d=l.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffEstAmt")),e=l.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffEstDiff")),f=l.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffEstcents")),j=l.byId(sap.ui.core.Fragment.createId("Cons2","idnrgCamOffCons"))),g=a.getProperty("Contract"),h=a.getProperty("RateCat"),i=j.getValue(),g&&h&&i?(b="/CpgCmpbyConsS(Contract='"+g+"',RateCat='"+h+"',Consumption="+i+")",k={success:function(a){a&&(c.setText("$ "+a.SimCurrInv||""),d.setText("$ "+a.EstInvAmt||""),f.setText((a.EstCents||"")+" ¢/kWh"),a.SimCurrInv&&a.EstInvAmt&&e.setText("$ "+(parseFloat(a.SimCurrInv)-parseFloat(a.EstInvAmt)).toFixed(2))),l.getOwnerComponent().getCcuxApp().setOccupied(!1)}.bind(this),error:function(){l.getOwnerComponent().getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Change Campaign",message:"Not able to retrieve comparision data"})}.bind(this)},n&&n.read(b,k)):this.getOwnerComponent().getCcuxApp().setOccupied(!1)},g.prototype._formatOfferTitle=function(a,b){return"C"===a?b?"CURRENT PLAN : "+b:"":b?b:""},g});