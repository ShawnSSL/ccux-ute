sap.ui.define(["nrg/base/view/BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","jquery.sap.global","sap/ui/model/json/JSONModel","sap/ui/core/format/DateFormat"],function(a,b,c,d,e,f){"use strict";var g=a.extend("nrg.module.quickpay.view.Mainfile");return g.prototype.onBeforeRendering=function(){var a,b,c,g,h=(this.getView().getModel("comp-quickpay"),this.getView().byId("idnrgQPPay-msgArea")),i=new e({reliantPay:!0,message:"",reliantText:"Verify",reliantPress:".onAcceptReliant",newBankRouting:"",newBankAccount:"",selected:0,CC:!1,BD:!1,PCC:!1,PBD:!1,REC:!1,RED:!1,PM:!0,ABD:!1,CL:!1,CLI:!1,SR:!1,showCloseButton:!0,showContactLog:!0,PendingRefresh:!1}),j=this;this._oFormatYyyymmdd=f.getInstance({pattern:"MM/dd/yyyy",calendarType:sap.ui.core.CalendarType.Gregorian}),this.getView().getModel("comp-quickpay").oData={},this._OwnerComponent=this.getView().getParent().getParent().getParent().getController().getOwnerComponent(),b=new sap.ui.model.json.JSONModel,this.getView().setModel(b,"quickpay-cl"),this.getView().setModel(i,"appView"),g=this._OwnerComponent.getGlobalDataManager(),this.getView().setModel(new sap.ui.model.json.JSONModel({current:!1,newAdd:!1,co:"",HouseNo:"",UnitNo:"",City:"",State:"",Country:"",AddrLine:"",Street:"",PoBox:"",ZipCode:"",NewAddrCheck:!1,NewAddressflag:!1,editable:!1}),"olocalAddress"),this.getView().setModel(new e,"oCorrModel"),this.getView().setModel(new sap.ui.model.json.JSONModel({isPrePay:!1,prePayDes:"Please Use Index to Set Up Prepay Auto Pay"}),"olocalCorrModel"),g.isPrepay()&&this.getView().getModel("olocalCorrModel").setProperty("/isPrePay",!0),this._initScrnControl(),"PCC"===this._Process?(this.onPendingCreditCard(),this._onPayFlagsRead()):"PBD"===this._Process?(this.onPendingBankDraft(),this._onPayFlagsRead()):(this._OwnerComponent.getCcuxApp().setOccupied(!0),a="/PayAvailFlagsSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",c=function(){d.sap.log.info("Date Received Succesfully"),j._OwnerComponent.getCcuxApp().setOccupied(!1)},this.getView().bindElement({model:"comp-quickpay",path:a,events:{dataReceived:c}})),h.addStyleClass("nrgQPPay-hide")},g.prototype._onPayFlagsRead=function(){var a=this.getView().getModel("comp-quickpay"),b="/PayAvailFlagsSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",c={success:function(){d.sap.log.info("Odata Read Successfully:::")}.bind(this),error:function(){d.sap.log.info("Odata Error occured")}.bind(this)};a&&a.read(b,c)},g.prototype._onToggleViews=function(a){var b=this.getView().getModel("appView");b.setProperty("/CC",!1),b.setProperty("/BD",!1),b.setProperty("/PCC",!1),b.setProperty("/PBD",!1),b.setProperty("/REC",!1),b.setProperty("/RED",!1),b.setProperty("/PM",!1),b.setProperty("/ABD",!1),b.setProperty("/CL",!1),b.setProperty("/CLI",!1),b.setProperty("/SR",!1),a="/"+a,b.setProperty(a,!0)},g.prototype.onCreditCard=function(){var a,b,c,e,f=this.getView().byId("idnrgQPCC-DDL"),g=this.getView().byId("idnrgQPCC-DDLItem"),h=this.getView().getModel("comp-quickpay"),i=this.getView().byId("idnrgQPCC-WaiveReasonItem"),j=this.getView().byId("idnrgQPCC-WR"),k=this.getView().byId("idnrgQPCC-Date"),l=this,m=new sap.ui.model.json.JSONModel,n=this.getView().byId("idnrgQPPay-msgArea"),o=this.getView().getModel("appView");this._bCreditCard=!0,this._onToggleViews("SR"),this.onRecordingPause(),k.setDefaultDate(this._oFormatYyyymmdd.format(new Date,!1)),this._OwnerComponent.getCcuxApp().setOccupied(!0),this.setShowCloseButton(!1),this.getView().setModel(m,"quickpay-cc"),e=function(a){d.sap.log.info("Data Received Succesfully"),a&&(1===a.getSource().getLength()?(j.setSelectedKey(a.getSource().getContexts()[0].getProperty("ReasonCode")),n.removeStyleClass("nrgQPPay-hide"),n.addStyleClass("nrgQPPay-black"),o.setProperty("/message",a.getSource().getContexts()[0].getProperty("Message"))):a&&a.mParameters&&a.mParameters.data&&a.mParameters.data.results&&a.mParameters.data.results.forEach(function(a){a&&a.DefaultFlag&&j.setSelectedKey(a.ReasonCode),a&&a.Message&&(n.removeStyleClass("nrgQPPay-hide"),n.addStyleClass("nrgQPPay-black"),o.setProperty("/message",a.Message))}))},a=function(a){d.sap.log.info("Data Received Succesfully"),a&&f.setPlaceholder(a&&a.mParameters&&a.mParameters.data&&a.mParameters.data.results[0]?"Select":"No stored cards"),l._OwnerComponent.getCcuxApp().setOccupied(!1)},c="/CreditCardSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",b={success:function(a){m.setData(a)}.bind(this),error:function(){d.sap.log.info("Error occured")}.bind(this)},h&&h.read(c,b),c="/CreditCardSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/CardsSet",b={model:"comp-quickpay",path:c,template:g,parameters:{countMode:"None",operationMode:"Server"},events:{dataReceived:a}},f.bindAggregation("content",b),c="/CreditCardSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/WaiveReasonsSet",b={model:"comp-quickpay",path:c,template:i,parameters:{countMode:"None"},events:{dataReceived:e}},j.bindAggregation("items",b)},g.prototype.onAcceptCredit=function(){var a,b,c,d,e,f,g,h,i,j,k=this.getView().getModel("comp-quickpay"),l=this.getView().byId("idnrgQPPay-msgArea"),m=this.getView().byId("idnrgQPCC-Date"),n=this.getView().byId("idnrgQPCC-DDL"),o=this.getView().byId("idnrgQPCC-Amt"),p=this.getView().byId("idnrgQPCC-WR"),q=this,r=this.getView().getModel("quickpay-cl"),s=this.getView().getModel("quickpay-cc"),t=this.getView().byId("idnrgQPCC-zipcode"),u=this.getView().byId("idnrgQPCC-cvv"),v="/PayAvailFlagsSet(BP='"+parseInt(this._sBP,10)+"',CA='"+parseInt(this._sCA,10)+"')",w=new Date;return g=k.getContext(v),q.getView().getModel("appView").setProperty("/message",""),l.removeStyleClass("nrgQPPay-hide"),l.addStyleClass("nrgQPPay-black"),this._ValidateValue(o.getValue(),"Enter Amount to be posted",!0)&&this._ValidateValue(m.getValue(),"Enter Credit Card Date")&&this._ValidateValue(n.getSelectedKey(),"Select Credit Card")&&this._ValidateValue(t.getValue(),"Enter Zip Code")&&this._ValidateValue(u.getValue(),"Enter CVV")?(b="/CreditCardPost",c=new Date(m.getValue()),d=s.getProperty("/InvoiceDate"),c&&(c.setHours("00"),c.setMinutes("00"),c.setSeconds("00")),d&&(d.setHours("00"),d.setMinutes("00"),d.setSeconds("00")),w&&(w.setHours("00"),w.setMinutes("00"),w.setSeconds("00")),i=c.getTime()>w.getTime()?g.getProperty("CaName")+", just to confirm, you have requested to make a payment today in the amount of  $"+parseFloat(o.getValue()).toFixed(2)+" to be processed on "+m.getValue()+". Is this correct?":g.getProperty("CaName")+", just to confirm, you have requested to make a payment today in the amount of  $"+parseFloat(o.getValue()).toFixed(2)+". Is this correct?",e=function(d){d&&(a={method:"POST",urlParameters:{ContractID:"",BP:q._sBP,CA:q._sCA,CardNumber:n.getSelectedKey(),PaymentDate:c,Amount:parseFloat(o.getValue()),WaiveFlag:p.getSelectedKey(),Cvval:u.getValue().trim(),ZipCode:t.getValue().trim(),Activit:"0",CardType:"0",Class:"0",Error:"0",InvoiceAmount:"0",InvoiceDate:1436109229e3,Message:"0",NameOnCard:"0",PopMessage:"0",UserDecision:!0,WaiveReason:"0"},success:function(a){""===a.Error?(r.setData(a),q.onPaymentSuccess(),l.addStyleClass("nrgQPPay-hide")):q.getView().getModel("appView").setProperty("/message",a.Message),q._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(a){q.getView().getModel("appView").setProperty("/message",a.statusText),q._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},q._OwnerComponent.getCcuxApp().setOccupied(!0),k.callFunction(b,a))},f=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:e(!0);break;case ute.ui.main.Popup.Action.No:e(!1)}},h=function(a){a&&(c.getTime()>w.getTime()&&c.getTime()>d.getTime()?ute.ui.main.Popup.Confirm({title:"Information",message:"Your Scheduled payment date is after the due date. You will be subject to applicable late fees and/or disconnection.",callback:f}):e(!0))},j=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:h(!0);break;case ute.ui.main.Popup.Action.No:h(!1)}},void ute.ui.main.Popup.Confirm({title:"Information",message:i,callback:j})):!1},g.prototype.onPendingCreditCard=function(){var a,b,c,f,g=this.getView().byId("idnrgQPPay-Popup"),h=this.getView().byId("idnrgQPPayBt-close"),i=this.getView().byId("idnrgQPTable-Row"),j=(this.getView().byId("idnrgQPTable-Rows"),"/CreditCardPPSet"),k=this.getView().getModel("comp-quickpay"),l=new e,m=this;this.setShowCloseButton(!1),this._OwnerComponent.getCcuxApp().setOccupied(!0),this._onToggleViews("PCC"),this._aPendingSelPaths=[],g.removeStyleClass("nrgQPPay-Popup"),g.addStyleClass("nrgQPPay-PopupPayment"),h.addStyleClass("nrgQPPayBt-closeBG"),this.getView().setModel(l,"QP-quickpay"),b=["BP","CA"],c=[this._sBP,this._sCA],f=this._createSearchFilterObject(b,c),a={filters:f,success:function(a){l.setData(a),i.setModel(l),d.sap.log.info("Odata Read Successfully:::"),m._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){d.sap.log.info("Error occured"),m._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},k&&k.read(j,a)},g.prototype.onPendingCCSave=function(){{var a,b=this.getView().getModel("comp-quickpay"),c=this.getView().getModel("QP-quickpay"),d=this;this.getView().getModel("quickpay-cl"),this.getView().byId("idnrgQPPay-msgArea"),this.getView().getModel("appView")}d._OwnerComponent.getCcuxApp().setOccupied(!0),this._aPendingSelPaths&&this._aPendingSelPaths.length>0?this._aPendingSelPaths.forEach(function(e){{var f=c.getContext(e);"/CreditCardPPSet(BP='"+d._sBP+"',CA='"+d._sCA+"',CardID='"+f.getProperty("CardID")+"')"}a={method:"POST",urlParameters:{CardID:f.getProperty("CardID"),CardNumber:f.getProperty("CardNumber"),ScheduledDate:f.getProperty("ScheduledDate"),Amount:f.getProperty("Amount"),ZipCode:f.getProperty("ZipCode"),BP:f.getProperty("BP"),CA:f.getProperty("CA"),ExpiryDate:f.getProperty("ExpiryDate")},success:function(a){""===a.Error?(d._OwnerComponent.getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Information",message:"Update Successful"}),d.onPopupClose()):d.getView().getModel("appView").setProperty("/message",a.Message),d._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){d._OwnerComponent.getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Information",message:"Update failed"}),d.onPopupClose()}.bind(this)},b.callFunction("/CreditCardUpdate",a)}):(d._OwnerComponent.getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Information",message:"No Record Selected"}))},g.prototype.onPendingCCSelected=function(a){var b,c,d,e,f=a.getSource().getParent(),g=this.getView().getModel("appView").getProperty("/selected");e=a.getSource().getBindingContext("QP-quickpay").getModel(),b=a.getSource().getParent().getBindingContext("QP-quickpay").getPath(),a.getSource().getChecked()?g&&1===g?(ute.ui.main.Popup.Alert({title:"Information",message:"Only one Record editable"}),a.getSource().setChecked(!1)):(c=this._aPendingSelPaths.indexOf(b),d=0>c&&this._aPendingSelPaths.push(b),g=1,this.getView().getModel("appView").setProperty("/selected",g),e.setProperty(a.getSource().getBindingContext("QP-quickpay").getPath()+"/Editable",!0),f.addStyleClass("nrgQPTable-RowsSelected")):(c=this._aPendingSelPaths.indexOf(b),d=c>-1&&this._aPendingSelPaths.splice(c,1),g=0,this.getView().getModel("appView").setProperty("/selected",g),f.removeStyleClass("nrgQPTable-RowsSelected"))},g.prototype.onPCCCancel=function(){var a=this.getView().getModel("QP-quickpay"),b=this.getView().getModel("comp-quickpay"),c=this,d="/PayAvailFlagsSet(BP='"+parseInt(this._sBP,10)+"',CA='"+parseInt(this._sCA,10)+"')",e=b.getContext(d),g=e.getProperty("CaName");this._aPendingSelPaths&&this._aPendingSelPaths.length>0?this._aPendingSelPaths.forEach(function(d){var e,h,i,j,k,l=a.getContext(d);e="/CreditCardPPSet(BP='"+l.getProperty("BP")+"',CA='"+l.getProperty("CA")+"',CardID='"+l.getProperty("CardID")+"')",l=b.getContext(e),j={method:"POST",urlParameters:{CardID:l.getProperty("CardID"),BP:l.getProperty("BP"),CA:l.getProperty("CA")},success:function(){ute.ui.main.Popup.Alert({title:"Information",message:"Scheduled Payment succesfully cancelled"}),c.onPopupClose()}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"Information",message:"Scheduled Payment Failed to cancel"})}.bind(this)},i=function(){e="/CreditCardCanc",b.callFunction(e,j)},k=function(a){if(a){var b,c,d,e,h,j=new ute.ui.commons.Tag,k=l.getProperty("ScheduledDate"),m=f.getInstance({pattern:"MM-dd-yyyy"});b="<div style='margin:10px; max-height: 200rem; overflow-y:auto'> <div>"+g+" has requested to cancel the One Time Scheduled Credit Card Payment below:</div><div style='margin:10px;'> Scheduled Authorization Date :: "+m.format(k)+"</div> <div style='margin:10px;'> Contract Account Number:: ",b+=l.getProperty("CA"),b+="</div><div style='margin:10px;'> Payment Amount:: ",b+=parseFloat(l.getProperty("Amount")).toFixed(2),b+="</div><div style='margin:10px;'> Do you wish to continue? ",c=new ute.ui.main.Button({text:"OK",press:function(){h.close(),i(!0)}}),d=new ute.ui.main.Button({text:"CANCEL",press:function(){h.close()}}),c.addStyleClass("nrgQPCC-btn"),d.addStyleClass("nrgQPCC-btn"),e=new sap.ui.core.HTML({content:b}),j.addContent(e),j.addContent(c),j.addContent(d),h=new ute.ui.main.Popup.create({title:"Validate",content:j}),h.open()}},h=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:k(!0);break;case ute.ui.main.Popup.Action.No:k(!1)}},ute.ui.main.Popup.Confirm({title:"Validate",message:"If Scheduled Credit Card Payment is cancelled you may be subject to applicable late fees and/or disconnection, unless other payment is received by the due date. Are you sure you want to cancel?",callback:h})}):ute.ui.main.Popup.Alert({title:"Information",message:"No Record Selected"})},g.prototype.onAddCC=function(){var a,b,c,e=this.getView().getModel("comp-quickpay"),f=this;c=function(){d.sap.log.info("Date Received Succesfully")},b="/CCCreateURLSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",a={success:function(a){var b,c=window.open(a.URL);b=setInterval(function(){c.closed&&(clearInterval(b),f.onRefreshCC())},1e3),d.sap.log.info("Odata Read Successfully:::")}.bind(this),error:function(){d.sap.log.info("Error occured")}.bind(this)},e&&e.read(b,a)},g.prototype.onDeclineCredit=function(a){this.onPopupClose(a)},g.prototype.onRefreshCC=function(){var a,b,c,e=this.getView().byId("idnrgQPCC-DDL"),f=this.getView().byId("idnrgQPCC-DDLItem"),g=this;g._OwnerComponent.getCcuxApp().setOccupied(!0),a=function(){d.sap.log.info("Date Received Succesfully"),g._OwnerComponent.getCcuxApp().setOccupied(!1)},c="/CreditCardSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/CardsSet",b={model:"comp-quickpay",path:c,template:f,parameters:{countMode:"None",operationMode:"Server"},events:{dataReceived:a}},e.bindAggregation("content",b)},g.prototype.onBankDraft=function(){var a,b,c,e,f=this.getView().byId("idnrgQPPay-Popup"),g=this.getView().byId("idnrgQPPayBt-close"),h=this.getView().byId("idnrgQPBD-Date"),i=this,j=this.getView().byId("idnrgQPCC-WaiveReasonItem"),k=this.getView().byId("idnrgQPCC-BankDraftItem"),l=this.getView().byId("idnrgQPBD-BankAccounts"),m=this.getView().byId("idnrgQPBD-WaiveReason"),n=new sap.ui.model.Sorter("LastUsed",!0),o=new sap.ui.model.json.JSONModel,p=this.getView().getModel("comp-quickpay"),q=this.getView().byId("idnrgQPPay-msgArea"),r=this.getView().getModel("appView");h.setDefaultDate(this._oFormatYyyymmdd.format(new Date,!1)),this.setShowCloseButton(!1),f.removeStyleClass("nrgQPPay-Popup"),f.addStyleClass("nrgQPPay-PopupWhite"),g.addStyleClass("nrgQPPayBt-closeBG"),this._onToggleViews("BD"),this.getView().setModel(o,"quickpay-bd"),this._OwnerComponent.getCcuxApp().setOccupied(!0),a="/BankDraftSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/WaiveReasonsSet",b=function(a){d.sap.log.info("Date Received Succesfully"),a&&l.setPlaceholder(a&&a.mParameters&&a.mParameters.data&&a.mParameters.data.results[0]?"Select":"No stored cards"),i._OwnerComponent.getCcuxApp().setOccupied(!1)},e=function(a){d.sap.log.info("Date Received Succesfully"),a&&(1===a.getSource().getLength()?(m.setSelectedKey(a.getSource().getContexts()[0].getProperty("ReasonCode")),q.removeStyleClass("nrgQPPay-hide"),q.addStyleClass("nrgQPPay-black"),r.setProperty("/message",a.getSource().getContexts()[0].getProperty("Message"))):a&&a.mParameters&&a.mParameters.data&&a.mParameters.data.results&&a.mParameters.data.results.forEach(function(a){a&&a.DefaultFlag&&m.setSelectedKey(a.ReasonCode),a&&a.Message&&(q.removeStyleClass("nrgQPPay-hide"),q.addStyleClass("nrgQPPay-black"),r.setProperty("/message",a.Message))}))},a="/BankDraftSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",c={success:function(a){o.setData(a)}.bind(this),error:function(){d.sap.log.info("Error occured")}.bind(this)},p&&p.read(a,c),a="/BankDraftSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/WaiveReasonsSet",c={model:"comp-quickpay",path:a,template:j,parameters:{countMode:"None"},events:{dataReceived:e}},m.bindAggregation("items",c),a="/BankDraftSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/BankAccountSet",c={model:"comp-quickpay",path:a,template:k,parameters:{countMode:"None"},sorter:n,events:{dataReceived:b}},l.bindAggregation("content",c)},g.prototype.onAcceptBankDraft=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this.getView().getModel("comp-quickpay"),s=this.getView().byId("idnrgQPPay-msgArea"),t=this.getView().byId("idnrgQPBD-Date"),u=this.getView().byId("idnrgQPBD-BankAccounts"),v=this.getView().byId("idnrgQPBD-Amt"),w=this.getView().byId("idnrgQPBD-WaiveReason"),x=this,y=this.getView().getModel("quickpay-cl"),z=this.getView().getModel("quickpay-bd"),A=new Date,B="/PayAvailFlagsSet(BP='"+parseInt(this._sBP,10)+"',CA='"+parseInt(this._sCA,10)+"')";return o=r.getContext(B),s.removeStyleClass("nrgQPPay-hide"),s.addStyleClass("nrgQPPay-black"),this._ValidateValue(v.getValue(),"Enter Amount to be posted",!0)&&this._ValidateValue(t.getValue(),"Enter Bank Draft Date")&&this._ValidateValue(u.getSelectedKey(),"Select Bank Account")?(b="/BankDraftpost",d=u.getSelectedKey(),f=r.getProperty("/BankAccountSet(BP='"+this._sBP+"',CA='"+this._sCA+"',BankKey='"+d+"')/BankAccNum"),e=r.getProperty("/BankAccountSet(BP='"+this._sBP+"',CA='"+this._sCA+"',BankKey='"+d+"')/BankRouting"),c=new Date(t.getValue()),i=parseInt(z.getProperty("/InvoiceAmount"),10)||0,j=z.getProperty("/InvoiceDate"),c&&(c.setHours("00"),c.setMinutes("00"),c.setSeconds("00")),j&&(j.setHours("00"),j.setMinutes("00"),j.setSeconds("00")),A&&(A.setHours("00"),A.setMinutes("00"),A.setSeconds("00")),n=c.getTime()>A.getTime()?o.getProperty("CaName")+", just to confirm, you have requested to make a payment today in the amount of  $"+parseFloat(v.getValue()).toFixed(2)+" to be drafted on "+t.getValue()+". Is this correct?":o.getProperty("CaName")+", just to confirm, you have requested to make a payment today in the amount of  $"+parseFloat(v.getValue()).toFixed(2)+". Is this correct?",h=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:g(!0);break;case ute.ui.main.Popup.Action.No:g(!1);break;case ute.ui.main.Popup.Action.Ok:}},k=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:l(!0);break;case ute.ui.main.Popup.Action.No:l(!1);break;case ute.ui.main.Popup.Action.Ok:}},l=function(a){a&&(v>0&&j.getTime()<c.getTime()?ute.ui.main.Popup.Confirm({title:"Information",message:"Your scheduled payment date is after the due date.  You will be subject to applicable late fees and/or disconnection.",callback:h}):g(!0))},g=function(g){g&&(a={method:"POST",urlParameters:{ContractID:"",BP:x._sBP,CA:x._sCA,BankAccNum:f,PaymentDate:c,Amount:parseFloat(v.getValue()),WaiveFlag:w.getSelectedKey(),BankKey:d,BankRouting:e,Activit:"0",Class:"0",Error:"0",InvoiceAmount:"0",InvoiceDate:1436109229e3,Message:"0",PopMessage:"0",UserDecision:!0,WaiveReason:"0"},success:function(a){""===a.Error?(y.setData(a),x.onPaymentSuccess(),s.addStyleClass("nrgQPPay-hide")):x.getView().getModel("appView").setProperty("/message",a.Message),x._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(a){x.getView().getModel("appView").setProperty("/message",a.statusText),x._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},x._OwnerComponent.getCcuxApp().setOccupied(!0),r.callFunction(b,a))},q=function(a){a&&(m=parseInt(v.getValue(),10)||0,m>i?ute.ui.main.Popup.Confirm({title:"Information",message:"Payment amount is greater than Total amount due. Do you wish to continue?",callback:k}):l(!0))},p=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:q(!0);break;case ute.ui.main.Popup.Action.No:q(!1)}},void ute.ui.main.Popup.Confirm({title:"Information",message:n,callback:p})):!1},g.prototype.onPendingBankDraft=function(){var a,b,c,f,g=this.getView().byId("idnrgQPPay-Popup"),h=this.getView().byId("idnrgQPPayBt-close"),i=this.getView().byId("idnrgQPTable-BDRow"),j=(this.getView().byId("idnrgQPTable-BDRows"),"/BankDraftPPSet"),k=this.getView().getModel("comp-quickpay"),l=new e,m=this;this.setShowCloseButton(!1),m._OwnerComponent.getCcuxApp().setOccupied(!0),this._onToggleViews("PBD"),this._aPendingSelPaths=[],g.removeStyleClass("nrgQPPay-Popup"),g.addStyleClass("nrgQPPay-PopupPayment"),h.addStyleClass("nrgQPPayBt-closeBG"),this.getView().setModel(l,"QP-quickpay"),b=["BP","CA"],c=[this._sBP,this._sCA],f=this._createSearchFilterObject(b,c),a={filters:f,success:function(a){l.setData(a),i.setModel(l),d.sap.log.info("Odata Read Successfully:::"),m._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){d.sap.log.info("Eligibility Error occured"),m._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},k&&k.read(j,a)},g.prototype.onPendingBDSelected=function(a){var b,c,d,e,f=a.getSource().getParent(),g=this.getView().getModel("appView").getProperty("/selected");e=a.getSource().getBindingContext("QP-quickpay").getModel(),b=a.getSource().getParent().getBindingContext("QP-quickpay").getPath(),a.getSource().getChecked()?g&&1===g?(ute.ui.main.Popup.Alert({title:"Information",message:"Only one Record editable"}),a.getSource().setChecked(!1)):(c=this._aPendingSelPaths.indexOf(b),d=0>c&&this._aPendingSelPaths.push(b),g=1,this.getView().getModel("appView").setProperty("/selected",g),e.setProperty(a.getSource().getBindingContext("QP-quickpay").getPath()+"/Editable",!0),f.addStyleClass("nrgQPTable-RowsSelected")):(c=this._aPendingSelPaths.indexOf(b),d=c>-1&&this._aPendingSelPaths.splice(c,1),g=0,this.getView().getModel("appView").setProperty("/selected",g),f.removeStyleClass("nrgQPTable-RowsSelected"))},g.prototype.onPBDCancel=function(){var a=this.getView().getModel("QP-quickpay"),b=this.getView().getModel("comp-quickpay"),c="/PayAvailFlagsSet(BP='"+parseInt(this._sBP,10)+"',CA='"+parseInt(this._sCA,10)+"')",d=b.getContext(c),e=d.getProperty("CaName"),g=this;this._aPendingSelPaths&&this._aPendingSelPaths.length>0?this._aPendingSelPaths.forEach(function(c){var d,h,i,j,k,l=a.getContext(c);d="/BankDraftPPSet(BP='"+l.getProperty("BP")+"',CA='"+l.getProperty("CA")+"',TrackingID='"+l.getProperty("TrackingID")+"')",l=b.getContext(d),l.getProperty("Editable")?(j={method:"POST",urlParameters:{TrackingID:l.getProperty("TrackingID"),BP:l.getProperty("BP"),CA:l.getProperty("CA")},success:function(){ute.ui.main.Popup.Alert({title:"Information",message:"Bank Draft scheduled Payment successfully cancelled"}),g.onPopupClose()}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"Information",message:"Bank Draft scheduled Payment cancellation failed"})}.bind(this)},i=function(a){a&&(d="/BankDraftCanc",b.callFunction(d,j))},k=function(a){if(a){var b,c,d,g,h,j=new ute.ui.commons.Tag,k=l.getProperty("ScheduledDate"),m=f.getInstance({pattern:"MM-dd-yyyy"});b="<div style='margin:10px; max-height: 200rem; overflow-y:auto'> <div>"+e+" has requested to cancel the One Time Bank Draft below:</div><div style='margin:10px;'> Debt Authorization Date :: "+m.format(k)+"</div> <div style='margin:10px;'> Contract Account Number:: ",b+=l.getProperty("CA"),b+="</div><div style='margin:10px;'> Payment Amount:: ",b+=parseFloat(l.getProperty("PaymentAmount")).toFixed(2),b=b+"</div><div style='margin:10px;'> Payment Date Requested :: "+m.format(k)+"</div>",b+="<div style='margin:10px;'> Do you wish to continue? </div></div>",c=new ute.ui.main.Button({text:"OK",press:function(){h.close(),i(!0)}}),d=new ute.ui.main.Button({text:"CANCEL",press:function(){h.close()}}),c.addStyleClass("nrgQPCC-btn"),d.addStyleClass("nrgQPCC-btn"),g=new sap.ui.core.HTML({content:b}),j.addContent(g),j.addContent(c),j.addContent(d),h=new ute.ui.main.Popup.create({title:"Validate",content:j}),h.open()}},h=function(a){switch(a){case ute.ui.main.Popup.Action.Yes:k(!0);break;case ute.ui.main.Popup.Action.No:k(!1)}},ute.ui.main.Popup.Confirm({title:"Validate",message:"If bank draft request is cancelled you may be subject to applicable late fees and/or disconnection, unless other payment is received by the due date. Are you sure you want to cancel?",callback:h})):ute.ui.main.Popup.Alert({title:"Information",message:"Cannot cancel since it is pass the deadline for same day cancels(5:00pm)."})}):ute.ui.main.Popup.Alert({title:"Information",message:"No Record Selected"})},g.prototype.onPendingBDSave=function(){var a,b=this.getView().getModel("comp-quickpay"),c=this.getView().getModel("QP-quickpay"),e=this,f=this.getView().byId("idnrgQPPay-msgArea"),g=this.getView().getModel("quickpay-cl"),h=this.getView().getModel("appView");e._OwnerComponent.getCcuxApp().setOccupied(!0),this._aPendingSelPaths&&this._aPendingSelPaths.length>0?this._aPendingSelPaths.forEach(function(i){{var j=c.getContext(i);[j.getProperty("BP"),j.getProperty("CA")],e.getView().byId("idnrgQPTable-BDRow")}e.getView().getModel("appView").setProperty("/selected",0),a={method:"POST",urlParameters:{RoutingNumber:j.getProperty("RoutingNumber"),AccountNumber:j.getProperty("AccountNumber"),ScheduledDate:j.getProperty("ScheduledDate"),PaymentAmount:j.getProperty("PaymentAmount"),TrackingID:j.getProperty("TrackingID"),ContractID:"",BP:j.getProperty("BP"),CA:j.getProperty("CA"),CurrentStatus:j.getProperty("CurrentStatus")},success:function(a){""===a.Error?(g.setData(a),e.onPaymentSuccess(),h.setProperty("/PendingRefresh",!0),e.attachEventOnce("ContactLogSaved",e.onPendingBankDraft),f.addStyleClass("nrgQPPay-hide")):e.getView().getModel("appView").setProperty("/message",a.Message),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){d.sap.log.info("Error occured"),e._OwnerComponent.getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Information",message:"Update failed"})}.bind(this)},b.callFunction("/BankDraftUpdate",a)}):(e._OwnerComponent.getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Information",message:"No Record Selected"}))},g.prototype.onAddBD=function(){this._onToggleViews("ABD")},g.prototype.onAddNewBD=function(){var a=this.getView().getModel("comp-quickpay"),b=this.getView().getModel("appView"),c="/BankAccountSet",d=this,e=b.getProperty("/newBankAccount"),f=b.getProperty("/newBankRouting"),g=this.getView().byId("idnrgQPPay-msgArea");return g.removeStyleClass("nrgQPPay-hide"),g.addStyleClass("nrgQPPay-black"),this._ValidateValue(e,"Enter Bank Account")&&this._ValidateValue(f,"Enter Routing Number")?(this._OwnerComponent.getCcuxApp().setOccupied(!0),void a.create(c,{ContractID:"",BP:this._sBP,CA:this._sCA,BankAccNum:e,BankRouting:f},{success:function(a){a.Error&&"X"===a.Error?d.getView().getModel("appView").setProperty("/message",a.Message):(d.getView().getModel("appView").setProperty("/message",""),d.onBankDraft()),d._OwnerComponent.getCcuxApp().setOccupied(!1)},error:function(){d._OwnerComponent.getCcuxApp().setOccupied(!1)}})):!1},g.prototype.onReliantCard=function(){var a=this.getView().byId("idnrgQPPay-Popup"),b=this.getView().byId("idnrgQPPayBt-close"),c=this.getView().byId("idnrgQPCC-RedDate"),d=this.getView().byId("idnrgQPCC-reliantRedeem");a.removeStyleClass("nrgQPPay-Popup"),a.addStyleClass("nrgQPPay-PopupWhite"),b.addStyleClass("nrgQPPayBt-closeBG"),d.addStyleClass("nrgQPPay-hide"),this._onToggleViews("RED"),this.setShowCloseButton(!1),c.setValue(this._oFormatYyyymmdd.format(new Date,!1)),c.setEditable(!1)},g.prototype.onAcceptReliant=function(){var a,b,c=this.getView().getModel("comp-quickpay"),e=this.getView().byId("idnrgQPPay-msgArea"),f=this.getView().byId("idnrgQPCC-reliantAccept"),g=this.getView().byId("idnrgQPCC-reliantRedeem"),h=this.getView().byId("idnrgQPCC-ReliantCard"),i=this;return a="/ReliantSet",e.removeStyleClass("nrgQPPay-hide"),e.addStyleClass("nrgQPPay-black"),this._ValidateValue(h.getValue(),"Enter Reliant Card")?(this._OwnerComponent.getCcuxApp().setOccupied(!0),a=a+"(BP='"+this._sBP+"',CA='"+this._sCA+"',ReliantCard='"+h.getValue()+"')",b={success:function(b){b&&""!==b.Error?i.getView().getModel("appView").setProperty("/message",b.Message):(i.getView().getModel("appView").setProperty("/message","Success"),i.getView().byId("idnrgQPCC-Amt2").bindElement({model:"comp-quickpay",path:a}),f.addStyleClass("nrgQPPay-hide"),g.removeStyleClass("nrgQPPay-hide")),d.sap.log.info("Odata Read Successfully:::"),i._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){d.sap.log.info("Error occured")}.bind(this)},void(c&&c.read(a,b))):!1},g.prototype.onDeclineReliant=function(){this.getView().getParent().close()},g.prototype.onReliantCardChange=function(){this.getView().getModel("appView").setProperty("/reliantPay",!0)},g.prototype.onReliantRedeem=function(){var a,b,c=this.getView().getModel("comp-quickpay"),e=this.getView().byId("idnrgQPPay-msgArea"),f=this.getView().byId("idnrgQPCC-Amt2"),g=this,h=this.getView().byId("idnrgQPPay-Popup"),i=this.getView().byId("idnrgQPPayBt-close");this._OwnerComponent.getCcuxApp().setOccupied(!0),b=f.getBindingContext("comp-quickpay"),a="/ReliantSet",c.create(a,{ContractID:"",BP:b.getProperty("BP"),CA:b.getProperty("CA"),ReliantCard:b.getProperty("ReliantCard"),Amount:b.getProperty("Amount")},{success:function(){h.removeStyleClass("nrgQPPay-PopupWhite"),h.addStyleClass("nrgQPPay-Popup"),i.addStyleClass("nrgQPPayBt-closeBG"),g.getView().getModel("appView").setProperty("/showContactLog",!1),g._onToggleViews("CLI"),e.addStyleClass("nrgQPPay-hide"),d.sap.log.info("Create successfull"),g._OwnerComponent.getCcuxApp().setOccupied(!1)},error:function(){g.getView().getModel("appView").setProperty("/message","Error at backend"),d.sap.log.info("Create Failure"),g._OwnerComponent.getCcuxApp().setOccupied(!1)}})},g.prototype.onReceipt=function(){var a,b=this.getView().byId("idnrgQPPay-Popup"),c=this.getView().byId("idnrgQPPayBt-close"),d=(this.getView().byId("idnrgQPCC-ReceiptDD"),this.getView().byId("idnrgQPCC-WaiveReasonItem"),this.getView().getModel("comp-quickpay"),this.getView().byId("idnrgQPRC-RcDate"));this.setShowCloseButton(!1),d.setValue(this._oFormatYyyymmdd.format(new Date,!1)),b.removeStyleClass("nrgQPPay-Popup"),b.addStyleClass("nrgQPPay-PopupWhite"),c.addStyleClass("nrgQPPayBt-closeBG"),this._onToggleViews("REC"),a="/ReceiptSet(BP='"+this._sBP+"',CA='"+this._sCA+"')/WaiveReasonsSet"},g.prototype.onAcceptReceipt=function(){var a,b=this.getView().getModel("comp-quickpay"),c=this.getView().byId("idnrgQPPay-msgArea"),d=(this.getView().byId("idnrgQPRC-RcDate"),this.getView().byId("idnrgQPRC-RNum")),e=this.getView().byId("idnrgQPRC-Amt"),f=this,g=this.getView().getModel("quickpay-cl");return c.removeStyleClass("nrgQPPay-hide"),c.addStyleClass("nrgQPPay-black"),this._ValidateValue(d.getValue(),"Enter Receipt Number")&&this._ValidateValue(e.getValue(),"Enter Amount",!0)?(this._OwnerComponent.getCcuxApp().setOccupied(!0),a="/ReceiptSet",void b.create(a,{ContractID:"",BP:this._sBP,CA:this._sCA,ReceiptNumber:d.getValue().trim(),Amount:e.getValue().trim()},{success:function(a){""===a.Error?(g.setData(a),f.onPaymentSuccess(),c.addStyleClass("nrgQPPay-hide")):f.getView().getModel("appView").setProperty("/message",a.Message),f._OwnerComponent.getCcuxApp().setOccupied(!1)},error:function(a){f.getView().getModel("appView").setProperty("/message",a.statusText),f._OwnerComponent.getCcuxApp().setOccupied(!1)}})):!1},
g.prototype.formatAccountNumber=function(a){return void 0!==a&&null!==a&&""!==a&&a.split("-").length>1?a.split("-")[1]:""},g.prototype.formatCardNumber=function(a){return void 0!==a&&null!==a&&""!==a&&a.split("-").length>1?a.split("-")[2]:""},g.prototype._ValidateValue=function(a,b,c){return c?!a||0>=a?(this.getView().getModel("appView").setProperty("/message",b),!1):!0:void 0===a||null===a||""===a?(this.getView().getModel("appView").setProperty("/message",b),!1):!0},g.prototype.formatCCType=function(a){return void 0===a||null===a||""===a?"":"ZVIS"===a?"sap-icon://nrg-icon/cc-visa":"ZDSC"===a?"sap-icon://nrg-icon/cc-discover":"ZMCD"===a?"sap-icon://nrg-icon/cc-mastercard":"ZATM"===a?"sap-icon://nrg-icon/cc-visa":void 0},g.prototype.onStopRec=function(){var a=this.getView().byId("idnrgQPPay-Popup"),b=this.getView().byId("idnrgQPPayBt-close");a.removeStyleClass("nrgQPPay-Popup"),a.addStyleClass("nrgQPPay-PopupWhite"),b.addStyleClass("nrgQPPayBt-closeBG"),this._onToggleViews("CC")},g.prototype.onPopupClose=function(){var a="/RecordingSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",b={success:function(){}.bind(this),error:function(){}.bind(this)},c=this.getView().getModel("comp-quickpay");this._bCreditCard&&(c.update(a,{Resume:!0},b),this._bCreditCard=!1),this.getView().getParent().close()},g.prototype.onRecordingPause=function(){var a="/RecordingSet(BP='"+this._sBP+"',CA='"+this._sCA+"')",b={success:function(){}.bind(this),error:function(){}.bind(this)},c=this.getView().getModel("comp-quickpay");this._bCreditCard&&c.update(a,{Resume:!1},b)},g.prototype.onPaymentSuccess=function(){var a=this.getView().byId("idnrgQPPay-Popup"),b=this.getView().byId("idnrgQPPayBt-close");a.removeStyleClass("nrgQPPay-PopupPayment"),a.removeStyleClass("nrgQPPay-PopupWhite"),a.addStyleClass("nrgQPPay-Popup"),b.addStyleClass("nrgQPPayBt-closeBG"),this._onToggleViews("CLI")},g.prototype.onContactLog=function(){var a=this.getView().byId("idnrgQPPay-Popup");this.getView().getModel("appView").getProperty("/showContactLog")?(this._onToggleViews("CL"),a.removeStyleClass("nrgQPPay-Popup"),a.addStyleClass("nrgQPPay-PopupPayment")):this.onPopupClose()},g.prototype.onAcceptContactLog=function(){{var a=this.getView().getModel("quickpay-cl"),b=this.getView().getModel("comp-quickpay"),c="/ContactLogSet",d=this;this.getView().getModel("appView")}this._OwnerComponent.getCcuxApp().setOccupied(!0),b.create(c,{ContractID:"",BP:a.getProperty("/BP"),CA:a.getProperty("/CA"),Class:a.getProperty("/Class"),Activit:a.getProperty("/Activit"),PopMessage:a.getProperty("/PopMessage")},{success:function(a){""!==a.ContactLogID?d.onPopupClose():(ute.ui.main.Popup.Alert({title:"Information",message:"Contact log not created successfully."}),d.onPopupClose()),d._OwnerComponent.getCcuxApp().setOccupied(!1)},error:function(){d._OwnerComponent.getCcuxApp().setOccupied(!1),ute.ui.main.Popup.Alert({title:"Information",message:"Contact log not created successfully."}),a.getProperty("/PendingRefresh")?this.fireEvent("ContactLogSaved"):d.onPopupClose()}})},g.prototype.setShowCloseButton=function(a){var b=this.getView().getModel("appView");b.getProperty("/showCloseButton")!==a&&b.setProperty("/showCloseButton",a)},g.prototype.setPosition=function(a){0===a?this.getView().getParent().setPosition("left bottom","left bottom"):this.getView().getParent().setPosition("left bottom","left bottom")},g.prototype._createSearchFilterObject=function(a,d){var e,f=[];for(e=0;e<a.length;e+=1)f.push(new b(a[e],c.EQ,d[e],""));return f},g.prototype.updateRPSData=function(){var a="/PayAvailFlagsSet(BP='"+parseInt(this._sBP,10)+"',CA='"+parseInt(this._sCA,10)+"')",b=this.getView().getModel("comp-quickpay"),c=b.getContext(a),d=this.getView().getModel("olocalCorrModel");d.setProperty("/Rps",c.getProperty("Rps")),d.setProperty("/Rpt",c.getProperty("Rpt"))},g.prototype.onAutoBankDraft=function(){var a=this.getView().getModel("olocalAddress"),b=this.getView().getModel("olocalCorrModel");b.setProperty("/bankDraft",!0),b.setProperty("/creditCard",!1),a.setProperty("/current",!1),a.setProperty("/newAdd",!1),a.setProperty("/NewAddrCheck",!1),a.setProperty("/NewAddressflag",!1),a.setProperty("/editable",!1),this._oPpCorrespondencePopup||(this._oPpCorrespondencePopup=ute.ui.main.Popup.create({content:sap.ui.xmlfragment(this.getView().sId,"nrg.module.quickpay.view.Correspondence",this),title:"Send Correspondence"}),this.getView().addDependent(this._oPpCorrespondencePopup)),this._oPpCorrespondencePopup.open(),this._initToggleArea(),this.updateRPSData(),this._selectScrn(!0)},g.prototype.onAutoCreditCard=function(){var a=this.getView().getModel("olocalAddress"),b=this.getView().getModel("olocalCorrModel");b.setProperty("/creditCard",!0),b.setProperty("/bankDraft",!1),a.setProperty("/current",!1),a.setProperty("/newAdd",!1),a.setProperty("/NewAddrCheck",!1),a.setProperty("/NewAddressflag",!1),a.setProperty("/editable",!1),this._oPpCorrespondencePopup||(this._oPpCorrespondencePopup=ute.ui.main.Popup.create({content:sap.ui.xmlfragment(this.getView().sId,"nrg.module.quickpay.view.Correspondence",this),title:"Send Correspondence"}),this.getView().addDependent(this._oPpCorrespondencePopup)),this._oPpCorrespondencePopup.open(),this._initToggleArea(),this.updateRPSData(),this._selectScrn(!0)},g.prototype._onCancelBtnClick=function(){this._oPpCorrespondencePopup.close()},g.prototype._initToggleArea=function(){this.getView().byId("id_QuickPayTglBtn").getLeftSelected()||(this.getView().byId("id_QuickPayTglBtn").setLeftSelected(!0),this._onToggleButtonPress(null))},g.prototype._retrCorrespondence=function(){var a,b,c=this.getView().getModel("comp-quickpay"),d=this.getView().getModel("olocalAddress"),e=this;this._OwnerComponent.getCcuxApp().setOccupied(!0),void 0===e._sContractId&&(this._sContractId=""),b="/AutoPayCorrs(BP='"+this._sBP+"',CA='"+this._sCA+"',CO='"+this._sContractId+"')",a={success:function(a){d.oData;a&&(this.getView().getModel("oCorrModel").setData(a),a.AddrCheck&&(d.setProperty("/current",!0),d.setProperty("/newAdd",!1)),a.Address&&(d.setProperty("/Address",{}),d.setProperty("/Address/co",a.Address.co),d.setProperty("/Address/HouseNo",a.Address.HouseNo),d.setProperty("/Address/UnitNo",a.Address.UnitNo),d.setProperty("/Address/City",a.Address.City),d.setProperty("/Address/State",a.Address.State),d.setProperty("/Address/Country",a.Address.Country),d.setProperty("/Address/Street",a.Address.Street),d.setProperty("/Address/PoBox",a.Address.PoBox),d.setProperty("/Address/ZipCode",a.Address.ZipCode))),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){}.bind(this)},c&&c.read(b,a)},g.prototype._sendCorrespondenceClicked=function(){var a=this.getView().getModel("oCorrModel"),b=this.getView().getModel("olocalCorrModel"),c=a.oData,d=this.getView().getModel("olocalAddress");if(b.getProperty("/creditCard")&&(b.setProperty("/creditCard",!0),b.setProperty("/bankDraft",!1),b.setProperty("/CCSetUp",!0),b.setProperty("/BDSetUp",!1),b.setProperty("/CCRemove",!1),b.setProperty("/BDRemove",!1)),b.getProperty("/bankDraft")&&(b.setProperty("/creditCard",!1),b.setProperty("/bankDraft",!0),b.setProperty("/BDSetUp",!0),b.setProperty("/CCSetUp",!1),b.setProperty("/CCRemove",!1),b.setProperty("/BDRemove",!1)),c.eMailCheck&&!c.eMail)return ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Email field is empty"}),!0;if(c.FaxCheck){if(!c.Fax)return ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter Fax Number"}),!0;if(!c.FaxTo)return ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter Fax To"}),!0}return c.AddrCheck&&d.getProperty("/newAdd")?d.getProperty("/Address/HouseNo")&&d.getProperty("/Address/Street")||d.getProperty("/Address/PoBox")?d.getProperty("/Address/City")?d.getProperty("/Address/State")?d.getProperty("/Address/ZipCode")?d.getProperty("/Address/Country")?(this._TrilliumAddressCheck(),!0):(ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter country"}),!0):(ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter zip Code"}),!0):(ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter state"}),!0):(ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter city"}),!0):(ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Please enter street no & street name or PO Box"}),!0):(this._sendCorrespondence(),!0)},g.prototype._onRemoveBtnClick=function(){var a,b,c=this.getView().getModel("comp-quickpay"),d=this.getView().getModel("olocalCorrModel"),e=this,f=this.getView().getModel("oCorrModel"),g=f.oData;this._OwnerComponent.getCcuxApp().setOccupied(!0),b="/AutoPayCorrs",a={merge:!1,success:function(a){ute.ui.main.Popup.Alert(a.Error?a.Message?{title:"Auto Pay",message:a.Message}:{title:"Auto Pay",message:"Correspondence Failed"}:a.Message?{title:"Auto Pay",message:a.Message}:{title:"Auto Pay",message:"Correspondence Sucessfully Sent"}),this._oPpCorrespondencePopup.close(),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Correspondence Failed"}),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},c&&(g.BDRemove=d.getProperty("/BDRemove"),g.CCSetUp=d.getProperty("/CCSetUp"),g.BDSetUp=d.getProperty("/BDSetUp"),g.CCRemove=d.getProperty("/CCRemove")),c.create(b,f.oData,a)},g.prototype._TrilliumAddressCheck=function(){var a,b,c=this.getView().getModel("olocalAddress"),d=this.getView().getParent().getParent().getParent().getController().getOwnerComponent().getModel("comp-bupa"),e=this,f=this._createAddrValidateFilters();this._OwnerComponent.getCcuxApp().setOccupied(!0),c.setProperty("/updateSent",!0),c.setProperty("/showVldBtns",!0),c.setProperty("/updateNotSent",!1),a="/BuagAddrDetails",b={filters:f,success:function(a){"X"===a.results[0].AddrChkValid?this._sendCorrespondence():(c.setProperty("/SuggAddrInfo",a.results[0].TriCheck),this._showSuggestedAddr(),this._selectScrn(!1,!0)),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){sap.ui.commons.MessageBox.alert("Validatation Call Failed"),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},d&&d.read(a,b)},g.prototype._createAddrValidateFilters=function(){var a,d,e,f=[],g=this.getView().getModel("olocalAddress"),h=g.getProperty("/Address");a=new b({path:"FixUpd",operator:c.EQ,value1:"X"}),f.push(a),a=new b({path:"PartnerID",operator:c.EQ,value1:this._sBP}),f.push(a),a=new b({path:"ChkAddr",operator:c.EQ,value1:"X"}),f.push(a);for(d in h)h.hasOwnProperty(d)&&"__metadata"!==d&&"StandardFlag"!==d&&"ShortForm"!==d&&"ValidFrom"!==d&&"ValidTo"!==d&&"Supplement"!==d&&(e="FixAddrInfo/"+d,a=new b({path:e,operator:c.EQ,value1:h[d]}),f.push(a));return f},g.prototype._showSuggestedAddr=function(){var a=this.getView().getModel("olocalAddress");a.setProperty("/updateSent",!0),a.setProperty("/showVldBtns",!0),a.setProperty("/updateNotSent",!1)},g.prototype._onPoBoxEdit=function(){var a=this.getView().getModel("olocalAddress");a.setProperty("/HouseNo",""),a.setProperty("/Street","")},g.prototype._compareSuggChkClicked=function(a){var b,c=this.getView().byId("idAddrUpdatePopup-l").getContent(),d=this.getView().byId("idAddrUpdatePopup-r").getContent();if(a.mParameters.checked)for(b=1;8>b;b+=1)c[b].getContent()[0].getValue()!==d[b].getContent()[0].getValue()&&(c[b].getContent()[0].addStyleClass("nrgQPPay-cusDataVerifyEditMail-lHighlight"),d[b].getContent()[0].addStyleClass("nrgQPPay-cusDataVerifyEditMail-rHighlight"));else for(b=1;8>b;b+=1)c[b].getContent()[0].getValue()!==d[b].getContent()[0].getValue()&&(c[b].getContent()[0].removeStyleClass("nrgQPPay-cusDataVerifyEditMail-lHighlight"),d[b].getContent()[0].removeStyleClass("nrgQPPay-cusDataVerifyEditMail-rHighlight"))},g.prototype._handleMailingAcceptBtn=function(){var a=this.getView().getModel("olocalAddress"),b=(a.getProperty("/Address"),a.getProperty("/SuggAddrInfo"));a.setProperty("/Address",b),this._sendCorrespondence()},g.prototype._handleMailingDeclineBtn=function(){this._sendCorrespondence()},g.prototype._handleMailingEditBtn=function(){var a=this.getView().getModel("olocalAddress");a.setProperty("/updateSent",!1),a.setProperty("/showVldBtns",!1),a.setProperty("/updateNotSent",!0)},g.prototype._initScrnControl=function(){var a=this.getView().getModel("olocalCorrModel");a.setProperty("/Correspondence",!1),a.setProperty("/Trillium",!1)},g.prototype._selectScrn=function(a,b){var c=this.getView().getModel("olocalCorrModel");a&&(c.setProperty("/Correspondence",!0),c.setProperty("/Trillium",!1),this._retrCorrespondence()),b&&(c.setProperty("/Correspondence",!1),c.setProperty("/Trillium",!0))},g.prototype._sendCorrespondence=function(){var a,b,c=this.getView().getModel("comp-quickpay"),d=this.getView().getModel("olocalCorrModel"),e=this,f=this.getView().getModel("oCorrModel"),g=f.oData,h=this.getView().getModel("olocalAddress");this._OwnerComponent.getCcuxApp().setOccupied(!0),b="/AutoPayCorrs",a={merge:!1,success:function(a){ute.ui.main.Popup.Alert(a.Error?a.Message?{title:"Auto Pay",message:a.Message}:{title:"Auto Pay",message:"Correspondence Failed"}:a.Message?{title:"Auto Pay",message:a.Message}:{title:"Auto Pay",message:"Correspondence Sucessfully Sent"}),this._oPpCorrespondencePopup.close(),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"Auto Pay",message:"Correspondence Failed"}),e._OwnerComponent.getCcuxApp().setOccupied(!1)}.bind(this)},c&&(g.BDRemove=d.getProperty("/BDRemove"),g.CCSetUp=d.getProperty("/CCSetUp"),g.BDSetUp=d.getProperty("/BDSetUp"),g.CCRemove=d.getProperty("/CCRemove"),h.getProperty("/newAdd")&&(g.Address.HouseNo=h.getProperty("/Address/HouseNo"),g.Address.UnitNo=h.getProperty("/Address/UnitNo"),g.Address.City=h.getProperty("/Address/City"),g.Address.State=h.getProperty("/Address/State"),g.Address.Country=h.getProperty("/Address/Country"),g.Address.AddrLine=h.getProperty("/Address/AddrLine"),g.Address.Street=h.getProperty("/Address/Street"),g.Address.PoBox=h.getProperty("/Address/PoBox"),g.Address.ZipCode=h.getProperty("/Address/ZipCode"),g.NewAddr=h.getProperty("/NewAddrCheck")),c.create(b,f.oData,a))},g.prototype._onComAddrCheck=function(){this.getView().getModel("olocalAddress").setProperty("/current",!0),this.getView().getModel("olocalAddress").setProperty("/newAdd",!1)},g.prototype._onCurrentAddCheck=function(){this.getView().getModel("olocalAddress").setProperty("/Address/co",this.getView().getModel("oCorrModel").getProperty("/Address/co")),this.getView().getModel("olocalAddress").setProperty("/Address/HouseNo",this.getView().getModel("oCorrModel").getProperty("/Address/HouseNo")),this.getView().getModel("olocalAddress").setProperty("/Address/UnitNo",this.getView().getModel("oCorrModel").getProperty("/Address/UnitNo")),this.getView().getModel("olocalAddress").setProperty("/Address/City",this.getView().getModel("oCorrModel").getProperty("/Address/City")),this.getView().getModel("olocalAddress").setProperty("/Address/State",this.getView().getModel("oCorrModel").getProperty("/Address/State")),this.getView().getModel("olocalAddress").setProperty("/Address/Country",this.getView().getModel("oCorrModel").getProperty("/Address/Country")),this.getView().getModel("olocalAddress").setProperty("/Address/Street",this.getView().getModel("oCorrModel").getProperty("/Address/Street")),this.getView().getModel("olocalAddress").setProperty("/Address/PoBox",this.getView().getModel("oCorrModel").getProperty("/Address/PoBox")),this.getView().getModel("olocalAddress").setProperty("/Address/ZipCode",this.getView().getModel("oCorrModel").getProperty("/Address/ZipCode")),this.getView().getModel("olocalAddress").setProperty("/NewAddrCheck",!1),this.getView().getModel("olocalAddress").setProperty("/NewAddressflag",!1),this.getView().getModel("olocalAddress").setProperty("/editable",!1)},g.prototype._onNewAddCheck=function(){this.getView().getModel("olocalAddress").setProperty("/Address/co",""),this.getView().getModel("olocalAddress").setProperty("/Address/HouseNo",""),this.getView().getModel("olocalAddress").setProperty("/Address/UnitNo",""),this.getView().getModel("olocalAddress").setProperty("/Address/City",""),this.getView().getModel("olocalAddress").setProperty("/Address/State",""),this.getView().getModel("olocalAddress").setProperty("/Address/Country",""),this.getView().getModel("olocalAddress").setProperty("/Address/Street",""),this.getView().getModel("olocalAddress").setProperty("/Address/PoBox",""),this.getView().getModel("olocalAddress").setProperty("/Address/ZipCode",""),this.getView().getModel("olocalAddress").setProperty("/NewAddrCheck",!0),this.getView().getModel("olocalAddress").setProperty("/NewAddressflag",!0),this.getView().getModel("olocalAddress").setProperty("/editable",!0)},g.prototype._onToggleButtonPress=function(){var a=this.getView().getModel("olocalCorrModel");this.getView().byId("id_QuickPayTglBtn").getLeftSelected()?(this.getView().byId("paymentSetUp").setVisible(!0),this.getView().byId("paymentCancell").setVisible(!1),this.getView().byId("setUpAutoPay").setVisible(!0),this.getView().byId("removeAutoPay").setVisible(!1)):(this.getView().byId("paymentSetUp").setVisible(!1),this.getView().byId("paymentCancell").setVisible(!0),this.getView().byId("setUpAutoPay").setVisible(!1),this.getView().byId("removeAutoPay").setVisible(!0),a.getProperty("/creditCard")?(a.setProperty("/BDSetUp",!1),a.setProperty("/CCSetUp",!1),a.setProperty("/CCRemove",!0),a.setProperty("/BDRemove",!1)):a.getProperty("/bankDraft")&&(a.setProperty("/BDSetUp",!1),a.setProperty("/CCSetUp",!1),a.setProperty("/CCRemove",!1),a.setProperty("/BDRemove",!0)))},g});